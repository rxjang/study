# item 28. API 안정성을 확인하라
프로그래밍에서 안정적이고 표준적인 API를 선호하는 이유는 다음과 같다.
1. API가 변경되고 개발자가 이를 업데이트했다면, 여러 코드를 수동으로 업데이트 해야한다. 많은 요소가 이 API에 의존하고 있다면, 변경에 대응하거나 다른 대안을 찾는 것은 매우 어렵다.
2. 사용자가 새로운 API를 배워야 한다. 처음부터 안정적인 모듈을 공부는 것이 좋다.

하지만 좋은 API를 한 번에 설계 할 수는 없다. 우리는 API를 안정적으로 유지하기 위한 의견을 제시헤 군형을 맞춰야 한다. 
일단 작성자가 'API' 또는 'API의 일부'가 불안정하다면, 이를 명확하게 알려 줘야 한다. 일반적으로 버전을 활용해 라이브러리와 모듈 안정성을 나타낸다.
많이 사용하는 **시멘틱 버저닝**은 다음과 같이 구성된다.
* MAJOR 버전: 호환되지 않는 수준의 API 변경
* MINOR 버전: 이전 변경과 호환되는 기능을 추가
* PATCH 버전: 간단한 버그 수정  

안정적인 API에 새로운 요소를 추가 할 때, 아직 해당 요서가 안정적이지 않다면 다른 브랜치에 해당 요소를 두는 것이 좋다. 
일부 사용자가 이를 사용하도록 허용하려면 일단 Expreimental 메타 어노테이션을 사용해 사용자에게 아직 해당 요소가 안정적이지 않다는 것을 알려주는 것이 좋다.

```kotlin
@Expreimental(level = Experimental.Level.WARNING)
annotation class ExpreimentalNewApi

@ExpreimentalNewApi
suspend fun getUsers(): List<User> {
    
}
```
이러한 요서는 언제든지 변경될 수 있다. 요소를 오랜 시간동안 실험적 기능으로 유지하는 것을 두려워 말자. 채택 속도는 느리지만, 더 오래 동안 좋은 API를 설계하는 데 도움이 된다. 

안정적인 API의 일부를 변경해야 한다며느 전환하는 데 시간을 두고 Deprecated 어노테이션을 활용해 사용자에게 미리 알려주자. 
직접적인 대안이 있다면 ReplaceWith를 붙여주는 것도 좋다.
```kotlin
@Deprecated("Use suspending getUsers instead")
ReplaceWith("getUsers()")
fun getUsers(callback: (List<User>) -> Unit) {
    
}
```

## 정리
사용자는 API의 안정성에 대해 알아야 한다. 다만 안정적이라고 생각했던 API에 예상하지 못한 변경이 일어났다면 가장 나쁜 상황이다. 
따라서 모듈과 라이브러리를 만드는 사람과 이를 사용하는 사람들 사이에 커뮤니케이션이 중요하다. 
커뮤니케이션은 버전 이름, 문서, 어노테이션 등을 통해 할 수 있다. 
또한 안정적인 API에 변경을 가할 때는 사용자가 적용할 충분한 시간을 주자.

