# chap02. 개략적인 규모 추정
개략적 규모 추정을 효과적으로 해내기 위해선 규모 확장성을 표현하는데 필요한 기본기에 능숙해야한다. 
특히, 2제곱수나 응답지연(latency) 값, 그리고 고가용성에 관계된 수치들은 기본적으로 잘 이해하고 있어야 한다.
## 2의 제곱수
분산 시스템에서 다루는 데이터 양은 엄청나게 커질 수 있으나 계산법은 기본을 크게 벗어나지 않는다. 
제대로된 계산 결과를 얻으려면 데이터 볼륨의 단위를 2의 제곱수로 표현하면 어떻게 되는지 우선 알아야 한다. 

|2의 x 제곱| 근사치 | 이름 | 축약형|
|--|---|---|---|
|10|1천(thousand)|1Kilobyte|1KB|
|20|1백만(million)|1Megabyte|1MB|
|30|10억(billion)|1Gigabyte|1GB|
|40|1조(trillion)|1Terabyte|1TB|
|50|1000조(quadrillion)|1Petabyte|1PB|

## 모든 프로그래머가 알아야 하는 응답지연 값
구글의 제프 딘은 2010년에 통상적인 컴퓨터에서 구현된 연산들의 응답지연 값들을 공개한 바 있다.
수치들을 분석하면 다음과 같은 결론이 나온다.
* 메모리는 빠르지만 디스크는 아직도 느리다.
* 디스크 탐색은 가능한 피하라.
* 단순한 압축 알고리즘은 빠르다.
* 데이터를 인터넷으로 전송하기 전에 가능하면 압축하라.
* 데이터 센터는 보통 여러 지역에 분산되어 있고, 센터들 간에 데이터를 주고받는 데는 시간이 걸린다. 

## 가용성에 관계된 수치들
고가용성은 시스템이 오랜 시간 동안 지속적으로 중단 없이 운영될 수 있는 능력을 지칭하는 용어다. 
고가용성을 표현하는 값은 퍼센트로 표현하는데 100%는 시스템이 단 한 번도 중단된 적이 없었음을 의미힌다. 

## 예제: 트위터 QPS와 저장소 요구량 추정  
**가정**
* MAU는 3억명이다.
* 50%의 사용자가 트위털르 매일 사용한다.
* 평균적으로 각 사용자는 매일 2건의 트윗을 올린다.
* 미디어를 포함하는 트윗은 10% 정도다.
* 데이터는 5년간 보관된다.  

**추정**  
QPS 추정치
* DAU = 30억 * 50% = 1.5억
* QPS = 1.5억/2 트윗/ 24시간 / 3600초 = 약 3500
* 최대 QPS = 2 * QPS = 7000  

미디어 저장을 위한 저장소 요구량
* 평균 트윗 크기
  * tweet_id에 64바이트
  * 텍스트에 140바이트
  * 미디어에 1MB
* 미디어 저장소 요구량: 1.5억 * 2 * 10% * 1MB = 30TB/일
* 약 5년간 미디어를 보관하기 위한 저장소 요구량: 30TB * 365 * 5 = 약 55PB

## 팁
* 근사치를 활용해 계산하라
* 가정들은 적어두어라
* 단위를 붙이라
* QPS, 최대 QPS, 저장소 요구량, 캐시 요구량, 서버 수 등을 측정하는 것을 연습하자



